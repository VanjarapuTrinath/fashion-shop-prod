<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Fashion Shop{% endblock %}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* Light blue-gray background */
            /* Added padding-top to compensate for the fixed navbar */
            /* Adjust pt-20 if your actual nav bar height is different */
            padding-top: 80px; /* Equivalent to Tailwind's pt-20 if 1rem=16px and nav is 80px tall */
        }
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e2e8f0; /* bg-gray-200 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #94a3b8; /* bg-gray-400 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* bg-gray-500 */
        }

        /* Styles for the scrolling image - moved here from index.html */
        .scrolling-container {
            width: 100%; /* Use 100% not 82vw to avoid small gaps */
            height: 400px; /* Adjust height as needed */
            overflow: hidden;
            border: none;
            border-radius: 0;
            box-shadow: none;
            background-color: #fff;
            position: relative;
        }

        .image-track {
            display: flex;
            white-space: nowrap;
            animation: scroll-left 40s linear infinite; /* Adjust duration */
        }

        .image-track img {
            height: 400px; /* Image height matches container height */
            width: auto;
            display: block;
            margin: 0 10px; /* Space around images */
            flex-shrink: 0;
            border-radius: 4px;
            object-fit: cover;
        }

        /* Keyframes for the scrolling animation */
        @keyframes scroll-left {
            0% {
                transform: translateX(0%);
            }
            100% {
                transform: translateX(-50%);
            }
        }

        /* Responsive adjustments for scrolling image */
        @media (max-width: 768px) {
            .scrolling-container {
                height: 250px; /* Adjusted for smaller screens */
            }
            .image-track img {
                height: 250px;
                margin: 0 5px;
            }
            .image-track {
                animation-duration: 30s;
            }
        }

        @media (max-width: 480px) {
            .scrolling-container {
                height: 150px;
            }
            .image-track img {
                height: 150px;
                margin: 0 3px;
            }
            .image-track {
                animation-duration: 20s;
            }
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">
    <nav class="bg-gray-800 text-gray-200 shadow-xl fixed w-full z-50 top-0">
        <div class="container mx-auto px-6 py-4 flex items-center justify-between">

            <div class="flex-shrink-0">
                <a href="{{ url_for('home') }}" class="flex items-center space-x-2 text-xl font-bold tracking-wide hover:text-indigo-400 transition-colors duration-300">
                    <svg class="h-8 w-8 text-indigo-400" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 4v1m-6-10H4m4 0h8m-10 4H3m2 0h8"></path>
                    </svg>
                    <span>FashionShop</span>
                </a>
            </div>

            <div class="hidden md:flex flex-grow justify-center">
                <div class="flex items-center space-x-10">
                    <a href="{{ url_for('products') }}" class="relative text-lg font-medium hover:text-indigo-400 transition-colors duration-300 group">
                        Products
                        <span class="absolute left-0 bottom-0 w-full h-0.5 bg-indigo-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
                    </a>
                    <a href="{{ url_for('cart') }}" class="relative text-lg font-medium hover:text-indigo-400 transition-colors duration-300 group">
                        Cart
                        <span id="cart-count" class="absolute -top-2 -right-6 bg-pink-600 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center shadow-md">
                            {{ current_user.is_authenticated and current_user.cart_items | length or 0 }}
                        </span>
                        <span class="absolute left-0 bottom-0 w-full h-0.5 bg-indigo-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
                    </a>
                    <a href="{{ url_for('order_history') }}" class="relative text-lg font-medium hover:text-indigo-400 transition-colors duration-300 group">
                        Orders
                        <span class="absolute left-0 bottom-0 w-full h-0.5 bg-indigo-400 transform scale-x-0 group-hover:scale-x-100 transition-transform duration-300 origin-left"></span>
                    </a>
                </div>
            </div>

            <div class="flex items-center space-x-4">
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('profile') }}" class="hidden md:block text-lg font-medium hover:text-indigo-400 transition-colors duration-300">Profile</a>
                    {% if current_user.is_admin %}
                    <a href="{{ url_for('admin_add_product') }}" class="hidden md:block text-lg font-medium hover:text-indigo-400 transition-colors duration-300">Admin</a>
                    {% endif %}
                    <a href="{{ url_for('logout') }}" class="bg-red-600 hover:bg-red-700 text-white px-5 py-2 rounded-full text-base font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">Logout</a>
                {% else %}
                    <a href="{{ url_for('login') }}" class="text-lg font-medium hover:text-indigo-400 transition-colors duration-300">Login</a>
                    <a href="{{ url_for('register') }}" class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-full text-base font-semibold transition-all duration-300 transform hover:scale-105 shadow-lg">Sign Up</a>
                {% endif %}

                <button class="md:hidden text-gray-200 hover:text-indigo-400 focus:outline-none">
                    <svg class="h-8 w-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                    </svg>
                </button>
            </div>

        </div>
    </nav>

    <main class="flex-grow container mx-auto px-4 py-8">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="mb-6">
                {% for category, message in messages %}
                    <div class="p-3 rounded-lg text-sm {% if category == 'success' %}bg-green-100 text-green-800{% elif category == 'danger' %}bg-red-100 text-red-800{% elif category == 'info' %}bg-blue-100 text-blue-800{% elif category == 'warning' %}bg-yellow-100 text-yellow-800{% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <footer class="bg-gray-800 text-white py-6 mt-auto">
        <div class="container mx-auto px-4 text-center text-sm">
            <p>&copy; {{ now().year }} FashionShop. All rights reserved.</p>
            <p class="mt-2">Designed with ❤️ by Your Trinath</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        // Set up global Flask variables for JS
        const FLASK_URLS = {
            addToCart: "{{ url_for('add_to_cart') }}", // Corrected endpoint name

            updateCart: "{{ url_for('update_cart_item') }}",
            removeFromCart: "{{ url_for('remove_from_cart') }}"
        };
        // Get initial cart count from Jinja2
        const initialCartCount = parseInt(document.getElementById('cart-count').innerText.trim());
        let currentCartCount = isNaN(initialCartCount) ? 0 : initialCartCount;

        // Function to update the cart count display
        function updateCartCountDisplay(newCount) {
            currentCartCount = newCount;
            const cartCountElement = document.getElementById('cart-count');
            if (cartCountElement) {
                cartCountElement.innerText = newCount;
            }
        }
    </script>
</body>
</html>